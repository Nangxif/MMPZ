$(function(){
    $("#register").on('click',function(){
        if($("#password").val()==$("#repassword").val()){
            $.ajax({
                type:'post',
                url:'/api/user/register',
                data:{
                    username:$("#username").val(),
                    mobilephone:$('#mobilephone').val(),
                    password:encrypt($("#password").val(),"nangxi"),
                    repassword:$("#repassword").val()
                },
                dataType:'json',
                success:function(result){
                    $('#Register-text').text(result.message);
                    //如果注册成功，那么跳转页面至首页
                    if(result.code==0){
                        $.ajax({
                            type:'post',
                            url:'/api/user/login',
                            data:{
                                username:$("#username").val(),
                                password:$("#password").val()
                            },
                            dataType:'json',
                            success:function(result){
                                $("#register_close").attr("data-dismiss","");
                                $("#register_close").attr("href","/user");
                            }
                        })
                    }else{//如果注册失败，则关闭弹框
                        $("#register_close").attr("data-dismiss","modal");
                    }
                }
            });
        }else{
            $('#Register-text').text("两次输入密码不一致,请核对后输入");
            $("#register_close").attr("data-dismiss","modal");
        }
    });
})